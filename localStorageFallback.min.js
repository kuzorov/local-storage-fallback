(function(){var localStorageFallback=function(){var fakeLocalStorage={};var storage;if(window.Storage&&window.localStorage){storage=window.Storage.prototype}else{window.localStorage={};storage=window.localStorage}if(!window.location.origin){window.location.origin=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"")}var dispatchStorageEvent=function(key,newValue){var oldValue=key==null?null:storage.getItem(key);var url=location.href.substr(location.origin.length);var storageEvent=document.createEvent("StorageEvent");storageEvent.initStorageEvent("storage",false,false,key,oldValue,newValue,url,null);window.dispatchEvent(storageEvent)};storage.key=function(i){var key=Object.keys(fakeLocalStorage)[i];return typeof key==="string"?key:null};storage.getItem=function(key){return typeof fakeLocalStorage[key]==="string"?fakeLocalStorage[key]:null};storage.setItem=function(key,value){dispatchStorageEvent(key,value);fakeLocalStorage[key]=String(value)};storage.removeItem=function(key){dispatchStorageEvent(key,null);delete fakeLocalStorage[key]};storage.clear=function(){dispatchStorageEvent(null,null);fakeLocalStorage={}}};if(typeof window.localStorage==="object"){try{localStorage.setItem("localStorageTest",1);localStorage.removeItem("localStorageTest")}catch(e){localStorageFallback()}}else{localStorageFallback()}})();
